# 辞海古卷 / Glyph Genius


## 简介

本项目是2023年因创新项目结识组成的团队 “智慧珠珠队” 的核心IP（个人比较喜欢卷济神经网络这个名字）。有幸作为开发者之一参与该项目从idea到初步落地的全流程，做此纪念。手写汉字识别OCR模型来源：[Baidu OCR](https://ai.baidu.com/ai-doc/index/OCR)。当前项目网址：[https://scroll.ihanzi.net/](https://scroll.ihanzi.net/release.html)


## 准备工作
项目本质是 HTML 网页。调试时为方便可以使用 VSCode 进行代码编辑，采用 VS code 中的 Live Server (Ritwick Dey) 实时调试插件进行编辑。安装完成后在 .html 文件中右键并选中 "open with live server"即可查看到前端网页。


### 后端部署
后端使用 Flask 框架开发，代码在 /flask 文件夹下。由于部署本框架的云服务器配置不够，故将绘画大模型、OCR模型部署在校内工作站上，通过信息办的外网端口访问，代码中内网 IP 地址已隐去。


### 百度翻译接口接入
访问 [Baidu OCR](https://api.fanyi.baidu.com/) 可申请使用免费翻译接口，在 main.py 中的 /translate 改为自己的 APP-ID 与 SecretKey 即可。


### 前端部署
首先确保电脑/服务器上已安装 node，再在空文件夹中创建 npm 项目：
```
Npm init

npm install
```

安装 webpack 部署所需的包：
```
npm  install express --save
```

执行 server.js 开放端口访问：
```
node server.js
```



## 界面展示


## 版本历史

### v1.0.0

2023年5月21日，双击打开卷轴

2023年6月12日，支持电脑鼠标、手机平板触摸（触摸屏暂不支持），可以在各基本功能页行基本交互

网页里面gif和图片加载的很慢，是云服务器带宽不够（口袋里米不够），耐心等一次把所有页面加载完毕之后就没问题了

### v1.1.0
更新功能：

1. 点击笔画选中，再次点击取消
2. 写汉字时笔迹更加丝滑
3. 识别出现错误/没有结果等会抛出错误并重回写字界面
4. 一次渲染6张图片
5. 在6张图片中作出选择时，选中的笔画闪烁
6. 渲染时弹窗显示进度，没渲染完也可以点击取消渲染
7. 开屏页单击即可启动卷轴
8. 优化输入标签页的UI

优化逻辑：

原先每次显示svg时都使用fetch函数去取，再通过一个记录选中了哪几笔的数组变粉；现在svg文件的内容只在onload加载中取一次，取到的结果深拷贝进入三个变量，变量可以在不同phase间传递，不用再定义一个数组记录选中了哪几笔了，也减少了很多异步操作：
* svgDoc_leave画布上显示的
* svgDoc_send发送给AI渲染的
* svgDoc_leave_deepcopy因为最后需要将选中的笔画删除，这个变量用来存放选中变粉、不中变灰的那个内容


### v1.2.0

更新功能：
1. 加入甲骨文等古文字展位、加入说文解字等接口
2. 点击选中6张渲染结果之一后可以返回重新选择
3. 支持平板触摸屏使用



## 团队成员

西兰花

社创的兔兔

大塞子SaiZi

大吉

bigrubber大橡皮

面包脑袋

Sherlock

独角兽粉末

W·J·H

Flora

疯子君

simba



## 特别鸣谢

GTY老师对于网页部署与运行速度提升给出了很多建议，进一步完善后再一一列出

GPT老师帮助我完成了其中70%的代码，也提供了很多的方便。特地列出几点：
* js中remove函数会改变数组索引，因此不能for循环遍历删除？   

 ————从后往前遍历

* HTML-js的深拷贝有内置函数 cloneNode(true)

* 能否使用python-opencv写一段代码，将一张白底彩色图片中的白底转为透明，其他部位的透明度和颜色不变

* python opencv将三通道图片转为四通道后绿色变成蓝色，这段代码有什么问题吗？ 

————在OpenCV中，颜色通道的顺序是BGR（蓝、绿、红）而非RGB（红、绿、蓝），因此，在将图像从BGR转换为RGBA时，B通道（蓝色）和R通道（红色）的位置会发生交换。您可以手动调整颜色通道顺序从BGR修改为RGB。
